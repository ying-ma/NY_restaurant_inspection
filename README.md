# NY_restaurant_inspection

# Who’s Getting a C?
Ying Ma  07/28/1018
Glossier Analytics Exam

While there are various aspects of approaching this dataset, I will focus on a single direction in this analysis, which is to help the inspectors prioritize the inspection process.

# 1. Introduction and background
According to the NYC restaurant inspection guidelines, the Health Department inspects about 24,000 restaurants per year to monitor compliance with City and State food safety regulations. Inspectors check for food handling, food temperature, personal hygiene, etc., and each violation earns a certain number of points. Restaurants with a total score between 0 and 13 points earn an A, those will 14 to 27 points receive a B and those with 28 or more a C. Therefore, the higher the score, the worse performance the restaurant has. When the score reaches 28 or grade C, the Health Department will revisit the restaurant on a monthly basis until the condition is improved. 
Consequently, it's very costly for both the restaurants and the Health Department if the restaurant's grade decreased to C. My goal of this analysis is to identify the restaurants that are at higher risk of falling to grade C and by conducting inspection ahead of scheduled time, hopefully the further degrading will be hindered or even prevented.
# 2. Target Design
The target I'm looking for is when the restaurant receives a grade C. Using the violation information of the inspection resulting grade C doesn't provide useful insights of predicting the event. Hence my strategy is to use the inspection information prior to reach grade C to construct a model which predicts the probability of the restaurant falling to grade C in the subsequent inspection. When a restaurant has a higher predicted probability, it means the restaurant is in jeopardy of getting grade C and hence should take higher priority for inspection. 
# 3. Feature Engineering
In the dataset, there are a lot of information about the inspection and the restaurants. Please refers to the appendix for features visualization and how each of them is constructed. In here, I will briefly discuss 2 of them. 
First and foremost is the duration of time to the next inspection. In the training dataset, this number corresponds to the time difference between current and next inspection. If this model is deployed to production, the value of this feature will increase as days go by. As a result, the probability of the restaurant getting grade C increases everyday as the duration from the time of last inspection gets longer. Because of other features of the restaurant and its past inspection history, the changing rate of predicted probability will be different. By adopting this strategy, the inspection priority can be dynamically updated on a daily basis.
Another feature I added is to bin the 67 different types of violations into 10 categories. These 10 categories were found on the NYC Health self-inspection worksheet (more details in the appendix). To reduce the features sparsity, I used number of violations in these 10 categories as features, denoted by vio_cat_x (x = 1,...10).
# 4. Model Evaluation and Interpretation
Random Forest Classifier and logistic regression are used to predict the event. Logistic regression has better interpretability and a better performance on test set with accuracy of 0.8 and AUC of ROC of 0.625. This result suggests that it is promising to use restaurant’s attributes and past inspection history to predict whether the restaurant is in jeopardy of getting a grade C. 
To further investigate which features are important to the model, top 50% coefficients  from logistic regression was plotted below. The positive coefficients means when the feature value increases, the probability of target also increases, while features with negative coefficients decreased the target probability with increased value. 
Violation in category 4 is the strongest positive predictor of logistic regression model. Category 4 is about food protection and penalize on presence of rats, mice, roaches and flies in the restaurant. This result also suggests that failure in pest control may potentially develop into  much bigger problem. Duration since last inspection and number of critical violations in the previous inspection are also among the top 3 positive predictors. This result proves my previous speculation that infrequent visit from inspectors may facilitate the downgrade of the restaurant. 
The negative coefficients are interesting as well. A lot of cuisine types have negative coefficients, such as American, Delicatessen and Sandwiches. This result can be interpreted as the restaurants of these cuisines are more resistant to downgrade and are good at maintaining their environment and score. Grade_C has the most negative coefficient, which reflects the fact that when the restaurant reaches grade C, a lot of efforts were devoted to bring them back to better grade.
